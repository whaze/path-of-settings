(()=>{"use strict";var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var s in a)e.o(a,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:a[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.React,a=window.wp.element,s=window.wp.i18n,i=window.wp.apiFetch;var l=e.n(i);const n=window.wp.components,o={text:({id:e,label:a,description:s,placeholder:i,value:l,onChange:o,error:r})=>(0,t.createElement)("div",{className:"pos-field pos-field-text"},(0,t.createElement)(n.TextControl,{label:a,help:r||s,value:l||"",onChange:o,placeholder:i,className:r?"has-error":""})),select:({id:e,label:a,description:s,options:i,value:l,onChange:o,error:r})=>{const c=Object.entries(i).map((([e,t])=>({value:e,label:t})));return(0,t.createElement)("div",{className:"pos-field pos-field-select"},(0,t.createElement)(n.SelectControl,{label:a,help:r||s,value:l||"",options:c,onChange:o,className:r?"has-error":""}))},checkbox:({id:e,label:a,description:s,value:i,onChange:l,error:o})=>(0,t.createElement)("div",{className:"pos-field pos-field-checkbox"},(0,t.createElement)(n.CheckboxControl,{label:a,help:o||s,checked:!!i,onChange:l,className:o?"has-error":""})),textarea:({id:e,label:a,description:s,placeholder:i,rows:l,value:o,onChange:r,error:c})=>(0,t.createElement)("div",{className:"pos-field pos-field-textarea"},(0,t.createElement)(n.TextareaControl,{label:a,help:c||s,value:o||"",onChange:r,placeholder:i,rows:l||5,className:c?"has-error":""})),image:({id:e,label:i,description:l,button_text:o,remove_text:r,value:c,onChange:d,error:m,image_data:p})=>{const[g,u]=(0,a.useState)(!1),[h,f]=(0,a.useState)(p||null);(0,a.useEffect)((()=>{!c||h&&h.id===parseInt(c)?c||f(null):E(c)}),[c]),(0,a.useEffect)((()=>{p&&f(p)}),[p]);const E=async e=>{try{const t=await fetch(`/wp-json/wp/v2/media/${e}`);if(t.ok){const e=await t.json(),a={id:e.id,url:e.media_details?.sizes?.medium?.source_url||e.source_url,width:e.media_details?.sizes?.medium?.width||e.media_details?.width,height:e.media_details?.sizes?.medium?.height||e.media_details?.height,alt:e.alt_text||"",title:e.title?.rendered||"",filename:e.slug||""};f(a)}}catch(e){console.error("Error fetching image data:",e)}},v=()=>{if("undefined"==typeof wp||!wp.media)return void console.error("WordPress media library not available");const e=wp.media({title:i,button:{text:o||(0,s.__)("Select Image","path-of-settings")},multiple:!1,library:{type:"image"}});e.on("select",(()=>{u(!0);const t=e.state().get("selection").first().toJSON(),a={id:t.id,url:t.sizes?.medium?.url||t.url,width:t.sizes?.medium?.width||t.width,height:t.sizes?.medium?.height||t.height,alt:t.alt||"",title:t.title||"",filename:t.filename||""};f(a),d(t.id),u(!1)})),e.open()},_=c&&h;return(0,t.createElement)("div",{className:"pos-field pos-field-image"},(0,t.createElement)("label",{className:"components-base-control__label"},i),l&&(0,t.createElement)("p",{className:"components-base-control__help"},l),m&&(0,t.createElement)("div",{className:"components-notice is-error"},(0,t.createElement)("div",{className:"components-notice__content"},m)),(0,t.createElement)("div",{className:"pos-image-field-content"},_?(0,t.createElement)("div",{className:"pos-image-preview"},(0,t.createElement)("div",{className:"pos-image-container"},(0,t.createElement)("img",{src:h.url,alt:h.alt||i,className:"pos-preview-image"}),(0,t.createElement)("div",{className:"pos-image-overlay"},(0,t.createElement)("div",{className:"pos-image-info"},(0,t.createElement)("span",{className:"pos-image-dimensions"},h.width," Ã— ",h.height)))),(0,t.createElement)("div",{className:"pos-image-actions"},(0,t.createElement)(n.Button,{isSecondary:!0,onClick:v,disabled:g},(0,s.__)("Change Image","path-of-settings")),(0,t.createElement)(n.Button,{isDestructive:!0,onClick:()=>{f(null),d("")},disabled:g},r||(0,s.__)("Remove Image","path-of-settings")))):(0,t.createElement)("div",{className:"pos-image-placeholder"},g?(0,t.createElement)("div",{className:"pos-uploading"},(0,t.createElement)(n.Spinner,null),(0,t.createElement)("p",null,(0,s.__)("Loading image...","path-of-settings"))):(0,t.createElement)("div",{className:"pos-no-image"},(0,t.createElement)("div",{className:"pos-upload-icon"},"ðŸ“·"),(0,t.createElement)(n.Button,{isPrimary:!0,onClick:v},o||(0,s.__)("Select Image","path-of-settings")),(0,t.createElement)("p",{className:"pos-upload-help"},(0,s.__)("Choose an image from your media library","path-of-settings"))))))}},r=()=>{const[e,i]=(0,a.useState)({}),[r,c]=(0,a.useState)(!0),[d,m]=(0,a.useState)(!1),[p,g]=(0,a.useState)(null),[u,h]=(0,a.useState)({}),f=window.posData?.currentPage||null;(0,a.useEffect)((()=>{f?E():c(!1)}),[f]);const E=async()=>{if(f){c(!0);try{const e=await l()({path:`/pos/v1/settings/${f.id}`,method:"GET"});i(e.settings||e),e.fields&&(f.fields=f.fields.map((t=>e.fields[t.id]?{...t,...e.fields[t.id]}:t))),h({}),g(null)}catch(e){console.error("Failed to load settings:",e),g({status:"error",message:(0,s.__)("Failed to load settings.","path-of-settings")})}finally{c(!1)}}};return f?r?(0,t.createElement)("div",{className:"pos-loading"},(0,t.createElement)(n.Spinner,null),(0,t.createElement)("p",null,(0,s.__)("Loading settings...","path-of-settings"))):(0,t.createElement)("div",{className:"pos-settings-page"},(0,t.createElement)("h1",null,f.title),p&&(0,t.createElement)(n.Notice,{status:p.status,onRemove:()=>g(null)},p.message),(0,t.createElement)(n.Panel,null,(0,t.createElement)(n.PanelBody,{title:(0,s.__)("Settings","path-of-settings"),initialOpen:!0},f.fields.map((a=>{const l=o[a.type];if(!l)return(0,t.createElement)(n.PanelRow,{key:a.id},(0,t.createElement)(n.Notice,{status:"error",isDismissible:!1},(0,s.__)(`Unknown field type: ${a.type}`,"path-of-settings")));const r=void 0!==e[a.id]?e[a.id]:a.config.default,c={id:a.id,value:r,onChange:t=>((t,a)=>{i({...e,[t]:a})})(a.id,t),error:u[a.id],...a.config};return"image"===a.type&&a.image_data&&(c.image_data=a.image_data),(0,t.createElement)(n.PanelRow,{key:a.id},(0,t.createElement)(l,{...c}))})))),(0,t.createElement)("div",{className:"pos-actions"},(0,t.createElement)(n.Button,{isPrimary:!0,onClick:async()=>{if(f){m(!0);try{const t=await l()({path:`/pos/v1/settings/${f.id}`,method:"POST",data:e});i(t),h({}),g({status:"success",message:(0,s.__)("Settings saved successfully.","path-of-settings")})}catch(e){console.error("Failed to save settings:",e),e.data?.errors&&h(e.data.errors),g({status:"error",message:(0,s.__)("Failed to save settings.","path-of-settings")})}finally{m(!1)}}},isBusy:d,disabled:d},d?(0,s.__)("Saving...","path-of-settings"):(0,s.__)("Save Settings","path-of-settings")))):(0,t.createElement)(n.Notice,{status:"error",isDismissible:!1},(0,s.__)("No page configuration found.","path-of-settings"))};document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("pos-app");e&&(0,a.createRoot)(e).render((0,t.createElement)(r,null))}))})();